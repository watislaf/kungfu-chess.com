service: rapid-chess-websocket

provider:
  name: aws
  runtime: nodejs18.x
  region: ${opt:region, 'us-east-1'}
  stage: ${opt:stage, 'prod'}
  memorySize: 256
  profile: 'watislaf'
  timeout: 10

functions:
  websocketHandler:
    handler: aws/socket-handler.handler
    events:
      - websocket:
          route: $connect
      - websocket:
          route: $disconnect
      - websocket:
          route: $default

resources:
  Outputs:
    WebSocketURI:
      Description: The WSS Protocol URI to connect to
      Value:
        Fn::Join:
          - ""
          - - "wss://"
            - Ref: WebsocketsApi
            - ".execute-api."
            - ${self:provider.region}
            - ".amazonaws.com/"
            - ${self:provider.stage}
      Export:
        Name: ${self:service}-${self:provider.stage}-websocket-uri

package:
  individually: true
  include:
    - aws/**
  exclude:
    - ./**
    - node_modules/aws-sdk/** # AWS SDK is provided in Lambda runtime 